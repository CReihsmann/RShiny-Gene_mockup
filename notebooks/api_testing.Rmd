---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(httr2)
library(tidyverse)
library(jsonlite)
library(httr)
```

```{r}
human_data <- read_csv('../data/20230602-human_data.csv')
```


```{r}
req <- request('www.proteinatlas.org/api/search_download.php')

resp <- req %>% 
    req_url_query(
        search = 'ENSG00000254647',
        format = 'json',
        columns = 'g,gs,gd,up',
        compress = 'no') %>% #,gs,gd,up,upbp,t_RNA_pancreas') %>%
    req_perform()

result <- fromJSON(resp %>% resp_body_string) 

```

getting ensemble gene ids
```{r}
req <- request('www.proteinatlas.org/api/search_download.php')

resp_ensb <- req %>% 
    req_url_query(
        search = '',
        format = 'json',
        columns = 'eg,g',
        compress = 'no') %>% 
    req_perform()

ensemble_dict <- fromJSON(resp_ensb %>% resp_body_string())

write_csv(ensemble_dict, '../data/ensemble_dict.csv')
```

UniProt api
```{r}
req_uniprot <- request('https://rest.uniprot.org/uniprotkb/search')

resp_uniprot <- req_uniprot %>% 
    req_url_query(
        fields = 'accession,id,sequence,lineage,fullName',#,ft_act_site,ft_binding,cc_pathway,cc_interaction,cc_developmental_stage,cc_tissue_specificity',
        query = 'accession:P01308',
        format = 'json'
    ) %>% 
    req_perform()

result_uniprot <-fromJSON(resp_uniprot %>% resp_body_string())
test <- result_uniprot$results
```

