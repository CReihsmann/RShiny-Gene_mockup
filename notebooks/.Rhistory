setwd("/Volumes/Macintosh HD/Users/isletcore/Documents/EDA/rna_mockup/notebooks")
library(tidyverse)
library(tidyverse)
library(ggplot2)
library(plotly)
human <- read_csv('../data/20230602-human_data.csv')
human <- read_csv('../data/20230602-human_data.csv')
nhp <- read_csv('../data/20230602-nhp_data.csv')
human <- read_csv('../data/20230602-human_data.csv')
nhp <- read_csv('../data/20230602-nhp_data.csv')
mouse <- read_csv('../data/20230602-mouse_data.csv')
human %>%
filter(celltype == 'GCG')
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr)) +
geom_col() +
coord_flip()
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = avg_expr)) +
geom_col() +
coord_flip()
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = pct_expr)) +
geom_col() +
coord_flip()
level_order <- c('Stellate', 'Immune', 'Endothelial', 'Epsilon', 'Beta', 'Alpha')
human$celltype <- factor(human$celltype, levels = level_order)
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = pct_expr)) +
geom_col() +
coord_flip()
unique(human$celltype)
human <- read_csv('../data/20230602-human_data.csv')
level_order <- c('Stellate', 'Immune', 'Endothelial', 'Gamma', 'Delta', 'Epsilon', 'Beta', 'Alpha')
human$celltype <- factor(human$celltype, levels = level_order)
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = pct_expr)) +
geom_col() +
coord_flip()
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr)) +
geom_col() +
coord_flip()
sum(human$pct_expr)
human %>%
filter(celltype == 'Alpha') %>%
sum(pct_expr)
human %>%
filter(celltype == 'Alpha') %>%
pull(sum(pct_expr))
human %>%
filter(celltype == 'Alpha')
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = pct_expr)) +
geom_col() +
coord_flip()
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr)) +
geom_col() +
coord_flip()
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip()
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr)) +
geom_col() +
coord_flip()
celltype
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip()
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.x = element_blank())
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank())
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.text = element_blank())
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position  = element_blank())
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = NULL)
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none')
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none') +
labs(y = 'Scaled Expression')
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none') +
labs(y = 'Scaled Expression') +
fill_palette(palette = c('blue', 'red', 'green', 'plum4', 'olivedrab4', 'pink3', 'orange3', 'violet'))
library(ggpubr)
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none') +
labs(y = 'Scaled Expression') +
fill_palette(palette = c('blue', 'red', 'green', 'plum4', 'olivedrab4', 'pink3', 'orange3', 'violet'))
colors <- c('violet', 'orange3', 'pink3', 'olivedrab4', 'plum4', 'green', 'red', 'blue')
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none') +
labs(y = 'Scaled Expression') +
fill_palette(palette = colors)
colors <- c('violet', 'orange3', 'pink3', 'olivedrab4', 'plum4', 'blue', 'green', 'red')
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none') +
labs(y = 'Scaled Expression') +
fill_palette(palette = colors)
level_order <- c('Stellate', 'Immune', 'Endothelial', 'Gamma', 'Epsilon', 'Delta', 'Beta', 'Alpha')
human$celltype <- factor(human$celltype, levels = level_order)
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none') +
labs(y = 'Scaled Expression') +
fill_palette(palette = colors)
human %>%
filter(Gene == 'SST') %>%
ggplot(aes(x=celltype, y = scaled_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none') +
labs(y = 'Scaled Expression') +
fill_palette(palette = colors)
human %>%
filter(Gene == 'SST') %>%
ggplot(aes(x=celltype, y = avg_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none') +
labs(y = 'Scaled Expression') +
fill_palette(palette = colors)
human %>%
filter(Gene == 'GCG') %>%
ggplot(aes(x=celltype, y = avg_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none') +
labs(y = 'Scaled Expression') +
fill_palette(palette = colors)
?geom_boxplot
human %>%
ggplot(aes(x = celltype, y = scaled_expr)) +
geom_boxplot()
human %>%
ggplot(aes(x = celltype, y = avg_expr)) +
geom_boxplot()
human %>%
ggplot(aes(x = celltype, y = scaled_expr)) +
geom_boxplot()
View(human)
View(mouse)
load('../data/Islets2.Rda)
library(Seurat)
d
load('../data/Islets2.Rda')
load('../data/Islets2.Rda')
avg <- AverageExpression(Islets,
assays = 'RNA',
features = rownames(Islets),
group.by = 'CellTypes',
slot = 'data')
avg <- AverageExpression(Islets,
assays = 'RNA',
features = rownames(Islets),
group.by = 'CellTypes',
slot = 'data')
library(Seurat)
avg <- AverageExpression(Islets,
assays = 'RNA',
features = rownames(Islets),
group.by = 'CellTypes',
slot = 'data')
View(avg)
avg_df <- avg$RNA
View(avg_df)
scaled <- avg_df, 'zscore')
scaled <- transform(avg_df, 'zscore')
scaled <- transform(avg_df, 'zscore')
View(scaled)
scaled <- transform(avg_df$Alpha, 'zscore')
scaled <- transform(avg_df@Alpha, 'zscore')
class(avg_df)
avg_df <- as.tibble(avg$RNA)
avg_df <- as_tibble(avg$RNA)
scaled <- transform(avg_df@Alpha, 'zscore')
scaled <- transform(avg_df, 'zscore')
scaled <- transform(avg_df$Alpha, 'zscore')
avg_df <- scale(avg$RNA)
?transform
avg_df <- as_tibble(avg$RNA)
scaled <- transform(avg_df$Alpha, method = 'zscore')
avg_df <- as_tibble(avg$RNA)
scaled <- transform(avg_df, method = 'zscore')
scaled <- transform(avg_df$Alpha, method = 'zscore')
avg_df <- scale(avg$RNA)
avg_df <- as_tibble(avg$RNA)
scaled <- scaled(avg_df)
scaled <- scale(avg_df)
scaled_2 <- scale(avg_df$Alpha)
View(scaled_2)
human <- read_csv('../data/20230602-human_data.csv')
nhp <- read_csv('../data/20230602-nhp_data.csv')
mouse <- read_csv('../data/20230602-mouse_data.csv')
human %>%
filter(Gene == 'INS') %>%
ggplot(aes(x=celltype, y = avg_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none') +
labs(y = 'Scaled Expression') +
fill_palette(palette = colors)
human <- read_csv('../data/20230602-human_data.csv')
human <- read_csv('../data/20230602-human_data.csv')
nhp <- read_csv('../data/20230602-nhp_data.csv')
nhp <- read_csv('../data/20230602-nhp_data.csv')
mouse <- read_csv('../data/20230602-mouse_data.csv')
colors <- c('violet', 'orange3', 'pink3', 'olivedrab4', 'plum4', 'blue', 'green', 'red')
level_order <- c('Stellate', 'Immune', 'Endothelial', 'Gamma', 'Epsilon', 'Delta', 'Beta', 'Alpha')
human$celltype <- factor(human$celltype, levels = level_order)
human %>%
filter(Gene == 'INS') %>%
ggplot(aes(x=celltype, y = avg_expr, fill = celltype)) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(axis.title.y = element_blank(),
legend.position = 'none') +
labs(y = 'Scaled Expression') +
fill_palette(palette = colors)
